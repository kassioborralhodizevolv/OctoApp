import { defineConfig } from 'vite';
import vue from '@vitejs/plugin-vue';
import autoprefixer from 'autoprefixer';
import path from 'path';
import fs from 'fs';
import handlebars from 'handlebars';
import { nodePolyfills } from 'vite-plugin-node-polyfills';

const pages = {"financiamento-imobiliario":{"outputDir":"./financiamento-imobiliario","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/financiamento-imobiliario/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/financiamento-imobiliario/"}]},"criar-nova-oportunidade":{"outputDir":"./criar-nova-oportunidade","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/criar-nova-oportunidade/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/criar-nova-oportunidade/"}]},"cartao-credito":{"outputDir":"./cartao-credito","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/cartao-credito/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/cartao-credito/"}]},"revisao-geral":{"outputDir":"./revisao-geral","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/revisao-geral/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/revisao-geral/"}]},"cadastrar-empresa":{"outputDir":"./cadastrar-empresa","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/cadastrar-empresa/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/cadastrar-empresa/"}]},"usuarios-tela-completa":{"outputDir":"./usuarios-tela-completa","lang":"pt","title":"Gestão de Usuários","cacheVersion":25,"meta":[{"name":"title","content":"Gestão de Usuários"},{"name":"description","content":"Tela de gestão de usuários com menu lateral, header, cores e tabela conforme solicitado."},{"name":"keywords","content":"usuários, gestão, menu, header, tabela, administração"},{"itemprop":"name","content":"Gestão de Usuários"},{"itemprop":"description","content":"Tela de gestão de usuários com menu lateral, header, cores e tabela conforme solicitado."},{"name":"twitter:card","content":"summary"},{"name":"twitter:title","content":"Gestão de Usuários"},{"name":"twitter:description","content":"Tela para gerenciar usuários com menu lateral, header e tabela detalhada."},{"property":"og:title","content":"Gestão de Usuários"},{"property":"og:description","content":"Tela para gerenciar usuários com menu lateral, header e tabela detalhada."},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/usuarios-tela-completa/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/usuarios-tela-completa/"}]},"analise-previa":{"outputDir":"./analise-previa","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/analise-previa/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/analise-previa/"}]},"analise-previa-calculo":{"outputDir":"./analise-previa-calculo","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/analise-previa-calculo/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/analise-previa-calculo/"}]},"relatorio-completo-calculo":{"outputDir":"./relatorio-completo-calculo","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/relatorio-completo-calculo/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/relatorio-completo-calculo/"}]},"cadastrar-cliente":{"outputDir":"./cadastrar-cliente","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/cadastrar-cliente/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/cadastrar-cliente/"}]},"detalhes_cliente":{"outputDir":"./detalhes_cliente","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/detalhes_cliente/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/detalhes_cliente/"}]},"editar-contato":{"outputDir":"./editar-contato","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/editar-contato/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/editar-contato/"}]},"codigo-verificacao":{"outputDir":"./codigo-verificacao","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/codigo-verificacao/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/codigo-verificacao/"}]},"permissoes-de-usuarios":{"outputDir":"./permissoes-de-usuarios","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/permissoes-de-usuarios/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/permissoes-de-usuarios/"}]},"geracao-de-peticoes":{"outputDir":"./geracao-de-peticoes","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/geracao-de-peticoes/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/geracao-de-peticoes/"}]},"configuracoes-gerais":{"outputDir":"./configuracoes-gerais","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/configuracoes-gerais/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/configuracoes-gerais/"}]},"crm":{"outputDir":"./crm","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/crm/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/crm/"}]},"detalhes-do-usuario":{"outputDir":"./detalhes-do-usuario","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/detalhes-do-usuario/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/detalhes-do-usuario/"}]},"contatos":{"outputDir":"./contatos","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/contatos/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/contatos/"}]},"index":{"outputDir":"./","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/"}]},"login":{"outputDir":"./login","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/login/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/login/"}]},"recuperar-senha":{"outputDir":"./recuperar-senha","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/recuperar-senha/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/recuperar-senha/"}]},"nova-senha":{"outputDir":"./nova-senha","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/nova-senha/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/nova-senha/"}]},"usuarios":{"outputDir":"./usuarios","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/usuarios/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/usuarios/"}]},"detalhes-do-contato":{"outputDir":"./detalhes-do-contato","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/detalhes-do-contato/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/detalhes-do-contato/"}]},"cadastrar-usuario":{"outputDir":"./cadastrar-usuario","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/cadastrar-usuario/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/cadastrar-usuario/"}]},"editar-usuarios":{"outputDir":"./editar-usuarios","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/editar-usuarios/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/editar-usuarios/"}]},"calculo-revisional":{"outputDir":"./calculo-revisional","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/calculo-revisional/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/calculo-revisional/"}]},"cadastrar-lead":{"outputDir":"./cadastrar-lead","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/cadastrar-lead/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/cadastrar-lead/"}]},"cadastro":{"outputDir":"./cadastro","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/cadastro/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/cadastro/"}]},"cadastrar-contato":{"outputDir":"./cadastrar-contato","lang":"pt","cacheVersion":25,"meta":[{"name":"twitter:card","content":"summary"},{"property":"og:type","content":"website"},{"name":"robots","content":"index, follow"}],"scripts":{"head":"\n","body":"\n"},"baseTag":{"href":"/","target":"_self"},"alternateLinks":[{"rel":"alternate","hreflang":"x-default","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/cadastrar-contato/"},{"rel":"alternate","hreflang":"pt","href":"https://3742a17d-a128-4dee-a937-650343a0620e.weweb-preview.io/cadastrar-contato/"}]}};

// Read the main HTML template
const template = fs.readFileSync(path.resolve(__dirname, 'template.html'), 'utf-8');
const compiledTemplate = handlebars.compile(template);

// Generate an HTML file for each page with its metadata
Object.values(pages).forEach(pageConfig => {
    // Compile the template with page metadata
    const html = compiledTemplate({
        title: pageConfig.title,
        lang: pageConfig.lang,
        meta: pageConfig.meta,
        scripts: {
            head: pageConfig.scripts.head,
            body: pageConfig.scripts.body,
        },
        alternateLinks: pageConfig.alternateLinks,
        cacheVersion: pageConfig.cacheVersion,
        baseTag: pageConfig.baseTag,
    });

    // Save output html for each page
    if (!fs.existsSync(pageConfig.outputDir)) {
        fs.mkdirSync(pageConfig.outputDir, { recursive: true });
    }
    fs.writeFileSync(`${pageConfig.outputDir}/index.html`, html);
});

const rollupOptionsInput = {};
for (const pageName in pages) {
    rollupOptionsInput[pageName] = path.resolve(__dirname, pages[pageName].outputDir, 'index.html');
}

export default defineConfig(() => {
    return {
        plugins: [nodePolyfills({ include: ['events', 'stream', 'string_decoder'] }), vue()],
        base: "/",
        resolve: {
            alias: {
                '@': path.resolve(__dirname, './src'),
            },
        },
        css: {
            preprocessorOptions: {
                scss: {
                    api: 'modern-compiler',
                },
            },
            postcss: {
                plugins: [autoprefixer],
            },
        },
        build: {
            chunkSizeWarningLimit: 10000,
            rollupOptions: {
                input: rollupOptionsInput,
                onwarn: (entry, next) => {
                    if (entry.loc?.file && /js$/.test(entry.loc.file) && /Use of eval in/.test(entry.message)) return;
                    return next(entry);
                },
                maxParallelFileOps: 900,
            },
        },
        logLevel: 'warn',
    };
});
